{% extends 'base.html' %}

{% load static %}


{% block title %}
  Mes Favoris
{% endblock %}

{% block content %}
  <div class="container mt-100">
    {% if favorites %}
      <div class="row row-cols-3">
      {% for favorite in favorites.all %}
        <div class="card justify-content-center align-items-center p-5">
          <div class="card-body">
            <img src="{{ favorite.image_url }}" alt="{{ favorite.product_name }}" height="auto" width="200">
          </div>
          <div class="card-footer">
            <p id="{{ favorite.id }}">{{ favorite.product_name }}</p>
            <p><a class="remove-link" href="{% url 'remove_favorite' %}">Retirer</a></p>
          </div>
        </div>
        {% if forloop.counter|divisibleby:"3" %}
          </div>
          <div class="row row-cols-3">
        {% endif %}
      {% endfor %}
    {% else %}
    <div class="justify-content-center align-items-center p-5 text-center">
      <p>Vous n'avez pas encore ajoute de favori</p>
    </div>
    {% endif %}
  </div>
{% endblock %}

{% block ajax %}
<script type="text/javascript">
  $(document).ready(function() {
    $('.remove-link').click(function(event) {
      event.preventDefault();
      $.ajax({
        url: "{% url 'remove_favorite' %}",
        type: "GET",
        data: {
          'product_id': this.parentNode.previousElementSibling.id,
        },
        success: function(res) {
          $('#' + res['id']).parent().parent().remove();
        }
      });
    });
  });
</script>
{% endblock %}
